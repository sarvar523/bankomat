<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>Ishchilar ro'yxati va kirish vaqti</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style2.css">
</head>
<body>
  <div class="info-box">
    <div class="stat">
        <button onclick="showBuxModal()" class="btn-primary">
            <i class="fas fa-calculator"></i>
            Buxgalteriya bo'limi
        </button>
    </div>
  </div>

  <!-- Buxgalteriya Login Modal -->
  <div class="modal" id="buxModal" style="display:none;">
      <div class="modal-content">
          <h2>Buxgalteriya bo'limiga kirish</h2>
          <form onsubmit="handleBuxLogin(event)">
              <div class="form-group">
                  <label>Login</label>
                  <input type="text" placeholder="buxgalter" id="buxUsername" required>
              </div>
              <div class="form-group">
                  <label>Parol</label>
                  <input type="password" placeholder="1234" id="buxPassword" required>
              </div>
              <button type="submit" class="btn-primary">Kirish</button>
          </form>
          <button class="close-btn" onclick="closeBuxModal()">&times;</button>
      </div>
  </div>

  <div class="info-box">
      <div class="title">Ishchilar ro'yxati va kirish vaqti</div>
      <div class="stat"><i class="fas fa-users"></i> Ishchilar soni: <span id="workerCount"></span></div>
      <div class="stat"><i class="fas fa-user-check"></i> Kirganlar soni: <span id="loginCount"></span></div>
      <div class="stat"><i class="fas fa-clock"></i> Oxirgi kirgan: <span id="lastLogin"></span></div>
      <div class="stat"><i class="fas fa-list"></i> Bugun ishda bo'lganlar: <span id="onlineCount"></span></div>
      <div class="workers-list" id="workersList"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
  <script>
      // Modal funksiyalari
      function showBuxModal() {
          document.getElementById("buxModal").style.display = "block";
      }
      function closeBuxModal() {
          document.getElementById("buxModal").style.display = "none";
      }

      // Login tekshiruv
      function handleBuxLogin(event) {
          event.preventDefault();
          const login = document.getElementById("buxUsername").value;
          const parol = document.getElementById("buxPassword").value;

          if (login === "buxgalter" && parol === "1234") {
              alert("Xush kelibsiz!");
              window.location.href = "index3.html"; // buxgalter bo'limi
          } else {
              alert("Login yoki parol noto‘g‘ri!");
          }
      }

      // Ishchilar ma'lumotlari
      const doctorImg = "https://img.freepik.com/free-photo/portrait-smiling-male-doctor_171337-1532.jpg?w=200&q=80";
      const doctorImgs = [
          "https://img.freepik.com/free-photo/young-female-doctor-white-coat-with-stethoscope_1150-21736.jpg?w=200&q=80",
          "https://img.freepik.com/free-photo/doctor-standing-with-arms-crossed_23-2147895396.jpg?w=200&q=80",
          "https://img.freepik.com/free-photo/portrait-smiling-doctor-with-stethoscope_23-2147895397.jpg?w=200&q=80",
          "https://img.freepik.com/free-photo/young-male-doctor-with-stethoscope_1303-17861.jpg?w=200&q=80"
      ];
      const workers = [
          { fullname: "Abdullaev Akmal" },
          { fullname: "Toshpulatova Dilnoza" },
          { fullname: "Karimov Diyor" },
          { fullname: "Ismoilova Nargiza" },
          { fullname: "Rasulov Shaxzod" },
          { fullname: "Ergasheva Malika" },
          { fullname: "Qodirov Bobur" },
          { fullname: "Sodiqova Mohira" },
          { fullname: "Yusupov Aziz" },
          { fullname: "Xudoyberdiyev Sardor" }
      ];

      function randomTime() {
          const hour = Math.floor(Math.random() * 3) + 8; // 8-10
          const min = Math.floor(Math.random() * 60);
          return `${hour}:${min.toString().padStart(2, '0')}`;
      }
      function randomStatus() {
          return Math.random() > 0.5;
      }

      let onlineCount = 0;
      const workersList = document.getElementById('workersList');
      workers.forEach((worker, i) => {
          const isOnline = randomStatus();
          if(isOnline) onlineCount++;
          const time = isOnline ? randomTime() : "-";
          const avatar = i === 0 ? doctorImg : doctorImgs[(i-1) % doctorImgs.length];
          workersList.innerHTML += `
              <div class="worker-card">
                  <img src="${avatar}" alt="Avatar" class="worker-avatar">
                  <div class="worker-name">${worker.fullname}</div>
                  <div class="worker-time">Kelgan vaqti: ${time}</div>
                  <div class="worker-status${isOnline ? "" : " offline"}">
                      ${isOnline ? "Ishda" : "Yo'q"}
                  </div>
              </div>
          `;
      });

      document.getElementById('workerCount').textContent = workers.length;
      document.getElementById('onlineCount').textContent = onlineCount;
      document.getElementById('loginCount').textContent = localStorage.getItem('loginCount') || 0;
      const lastLogin = JSON.parse(localStorage.getItem('lastLogin') || '{}');
      document.getElementById('lastLogin').textContent = lastLogin.time ? (lastLogin.user + " - " + lastLogin.time) : "Ma'lumot yo'q";
  </script>
</body>
</html>
